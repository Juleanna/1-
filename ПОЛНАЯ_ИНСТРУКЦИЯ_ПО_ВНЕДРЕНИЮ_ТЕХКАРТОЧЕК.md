# ПОЛНАЯ ИНСТРУКЦИЯ ПО ВНЕДРЕНИЮ СИСТЕМЫ ТЕХНОЛОГИЧЕСКИХ КАРТ

## СОДЕРЖАНИЕ
1. [Введение и обзор системы](#введение-и-обзор-системы)
2. [Предварительная подготовка](#предварительная-подготовка)
3. [Установка и настройка объектов конфигурации](#установка-и-настройка-объектов-конфигурации)
4. [Настройка справочника номенклатуры](#настройка-справочника-номенклатуры)
5. [Создание и настройка техкарточек](#создание-и-настройка-техкарточек)
6. [Работа с кулинарными рецептами](#работа-с-кулинарными-рецептами)
7. [Документ "Приготовление блюда"](#документ-приготовление-блюда)
8. [Интеграция с документами продаж](#интеграция-с-документами-продаж)
9. [Тестирование системы](#тестирование-системы)
10. [Ежедневное использование](#ежедневное-использование)
11. [Администрирование и обслуживание](#администрирование-и-обслуживание)
12. [Решение проблем](#решение-проблем)
13. [Дополнительные возможности](#дополнительные-возможности)

---

## ВВЕДЕНИЕ И ОБЗОР СИСТЕМЫ

### Что такое система технологических карт?
Система технологических карт (техкарточек) - это профессиональное решение для предприятий общественного питания, которое позволяет:

- **Стандартизировать процессы** приготовления блюд
- **Контролировать себестоимость** каждого блюда с точностью до копейки
- **Автоматически списывать ингредиенты** при продаже блюд
- **Планировать закупки** на основе меню и прогнозов продаж
- **Обеспечить соответствие** стандартам ГОСТ и СанПиН
- **Анализировать эффективность** использования продуктов

### Ключевые компоненты системы:
1. **Справочник "Техкарточки"** - основа системы, содержит детальную информацию о каждом блюде
2. **Справочник "КулинарныеРецепты"** - связующее звено между техкарточками и продажами
3. **Документ "Приготовление блюда"** - отдельный процесс для приготовления блюд и формирования запасов
4. **Автоматическое списание ингредиентов** - при продаже блюда автоматически списываются готовые блюда (без пересчета ингредиентов)
5. **Регистр "ПриготовлениеПоРецептам"** - аналитический учет фактического приготовления по рецептам
6. **Аналитические отчеты** - для анализа себестоимости и планирования

### Отличия от старой системы:
| Старая система | Новая система с техкарточками |
|---|---|
| Простая таблица ингредиентов в рецепте | Полная технологическая карта |
| Только количество ингредиентов | Нормы брутто/нетто с учетом отходов |
| Минимальная информация о блюде | Полная пищевая ценность (БЖУ, калории) |
| Нет технологии приготовления | Подробная технология и требования |
| Дублирование данных в каждом рецепте | Централизованное хранение в техкарточках |
| Списание ингредиентов при продаже | Раздельные процессы: приготовление → продажа |
| Нет контроля запасов готовых блюд | Полноценный учет готовой продукции |

---

## ПРЕДВАРИТЕЛЬНАЯ ПОДГОТОВКА

### Системные требования
- **1С:Предприятие** версии 8.3 или выше
- **Конфигурация** "Управление торговлей" или аналогичная
- **Права доступа** администратора для внедрения
- **Резервная копия** базы данных (обязательно!)

### Подготовка данных
Перед внедрением необходимо собрать следующую информацию:

1. **Полный список блюд**, которые продаются через кассу
2. **Перечень всех ингредиентов**, используемых в приготовлении
3. **Технологические карты** (если есть) в любом формате
4. **Нормы выхода** готовых блюд
5. **Время приготовления** для каждого блюда
6. **Данные о пищевой ценности** (если доступны)
7. **Поставщиков и цены** на ингредиенты

### Создание резервной копии
**⚠️ ВНИМАНИЕ!** Обязательно создайте резервную копию базы данных перед началом работ!

```
1. Запустите 1С:Предприятие в режиме "Конфигуратор"
2. Выберите меню "Администрирование" → "Выгрузить информационную базу"
3. Укажите путь для сохранения файла backup_ГГГГ-ММ-ДД.dt
4. Дождитесь завершения процесса выгрузки
```

### Планирование внедрения
Рекомендуемый план внедрения:
- **День 1-2**: Установка объектов конфигурации и настройка номенклатуры
- **День 3-5**: Создание техкарточек для основных блюд
- **День 6-7**: Создание рецептов и тестирование
- **День 8-10**: Обучение персонала и отладка
- **День 11+**: Промышленная эксплуатация

---

## УСТАНОВКА И НАСТРОЙКА ОБЪЕКТОВ КОНФИГУРАЦИИ

### Шаг 1: Добавление справочника "Техкарточки"

1. **Откройте конфигуратор 1С**
2. **В дереве конфигурации найдите узел "Справочники"**
3. **Добавьте новый справочник:**
   - Правой кнопкой на "Справочники" → "Добавить"
   - Имя: `Техкарточки`
   - Синоним: `Технологические карты`
   - Комментарий: `Справочник технологических карт блюд`

4. **Настройте основные свойства:**
   - Длина кода: 9
   - Тип кода: Строка
   - Длина наименования: 150
   - Автонумерация: Да
   - Уникальность кода: Да
   - Быстрый выбор: Да

5. **Создайте структуру справочника вручную:**

#### 5.1. Добавление реквизитов

**Правой кнопкой на узле "Реквизиты" → "Добавить"** для каждого реквизита:

**Реквизит "НомерТехкарточки":**
- Имя: `НомерТехкарточки`
- Синоним: `Номер техкарточки`
- Тип: Строка
- Длина: 20
- Комментарий: `Официальный номер технологической карты`

**Реквизит "ГотовоеБлюдо":**
- Имя: `ГотовоеБлюдо`
- Синоним: `Готовое блюдо`
- Тип: СправочникСсылка.Номенклатура
- Проверка заполнения: Выдавать ошибку
- Комментарий: `Ссылка на номенклатуру готового блюда`

**Реквизит "КатегорияБлюда":**
- Имя: `КатегорияБлюда`
- Синоним: `Категория блюда`
- Тип: ПеречислениеСсылка.КатегорииБлюд
- Комментарий: `Категория кулинарного изделия`

**Реквизит "ВыходПорции":**
- Имя: `ВыходПорции`
- Синоним: `Выход порции (г)`
- Тип: Число
- Длина: 10
- Точность: 1
- Неотрицательное: Да
- Комментарий: `Выход готовой порции в граммах`

**Реквизит "КалорийностьПорции":**
- Имя: `КалорийностьПорции`
- Синоним: `Калорийность порции (ккал)`
- Тип: Число
- Длина: 10
- Точность: 1
- Неотрицательное: Да
- Комментарий: `Энергетическая ценность порции в ккал`

**Реквизит "Белки":**
- Имя: `Белки`
- Синоним: `Белки (г)`
- Тип: Число
- Длина: 8
- Точность: 2
- Неотрицательное: Да
- Комментарий: `Содержание белков в порции`

**Реквизит "Жиры":**
- Имя: `Жиры`
- Синоним: `Жиры (г)`
- Тип: Число
- Длина: 8
- Точность: 2
- Неотрицательное: Да
- Комментарий: `Содержание жиров в порции`

**Реквизит "Углеводы":**
- Имя: `Углеводы`
- Синоним: `Углеводы (г)`
- Тип: Число
- Длина: 8
- Точность: 2
- Неотрицательное: Да
- Комментарий: `Содержание углеводов в порции`

**Реквизит "ВремяПриготовления":**
- Имя: `ВремяПриготовления`
- Синоним: `Время приготовления (мин)`
- Тип: Число
- Длина: 4
- Точность: 0
- Неотрицательное: Да
- Комментарий: `Время приготовления блюда в минутах`

**Реквизит "ТехнологияПриготовления":**
- Имя: `ТехнологияПриготовления`
- Синоним: `Технология приготовления`
- Тип: Строка
- Длина: Неограниченная
- Многострочный: Да
- Расширенное редактирование: Да
- Комментарий: `Подробное описание технологического процесса`

**Реквизит "ТребованияКСырью":**
- Имя: `ТребованияКСырью`
- Синоним: `Требования к качеству сырья`
- Тип: Строка
- Длина: Неограниченная
- Многострочный: Да
- Расширенное редактирование: Да
- Комментарий: `Требования к качеству используемого сырья и продуктов`

**Реквизит "ПоказателиГотовогоБлюда":**
- Имя: `ПоказателиГотовогоБлюда`
- Синоним: `Показатели готового блюда`
- Тип: Строка
- Длина: Неограниченная
- Многострочный: Да
- Расширенное редактирование: Да
- Комментарий: `Органолептические показатели готового блюда`

**Реквизит "СебестоимостьПорции":**
- Имя: `СебестоимостьПорции`
- Синоним: `Себестоимость порции`
- Тип: Число
- Длина: 15
- Точность: 2
- Неотрицательное: Да
- Комментарий: `Расчетная себестоимость одной порции`

#### 5.2. Создание табличной части "СоставИнгредиентов"

1. **Правой кнопкой на узле "Табличные части" → "Добавить"**
   - Имя: `СоставИнгредиентов`
   - Синоним: `Состав ингредиентов`
   - Комментарий: `Нормы вложения сырья и продуктов`

2. **Добавьте реквизиты табличной части** (правой кнопкой на созданной табличной части → "Добавить" → "Реквизит"):

**Реквизит "Ингредиент":**
- Имя: `Ингредиент`
- Синоним: `Наименование сырья`
- Тип: СправочникСсылка.Номенклатура
- Проверка заполнения: Выдавать ошибку
- Комментарий: `Наименование сырья и продуктов`

**Реквизит "НормаБрутто":**
- Имя: `НормаБрутто`
- Синоним: `Норма брутто (г)`
- Тип: Число
- Длина: 10
- Точность: 2
- Неотрицательное: Да
- Проверка заполнения: Выдавать ошибку
- Комментарий: `Норма закладки сырья в граммах брутто`

**Реквизит "НормаНетто":**
- Имя: `НормаНетто`
- Синоним: `Норма нетто (г)`
- Тип: Число
- Длина: 10
- Точность: 2
- Неотрицательное: Да
- Проверка заполнения: Выдавать ошибку
- Комментарий: `Норма закладки сырья в граммах нетто`

**Реквизит "ПроцентОтходов":**
- Имя: `ПроцентОтходов`
- Синоним: `% отходов`
- Тип: Число
- Длина: 5
- Точность: 2
- Неотрицательное: Да
- Комментарий: `Процент отходов при обработке`

**Реквизит "СтоимостьЕдиницы":**
- Имя: `СтоимостьЕдиницы`
- Синоним: `Цена за кг`
- Тип: Число
- Длина: 15
- Точность: 2
- Неотрицательное: Да
- Комментарий: `Стоимость единицы ингредиента`

**Реквизит "СуммаСтоимости":**
- Имя: `СуммаСтоимости`
- Синоним: `Сумма`
- Тип: Число
- Длина: 15
- Точность: 2
- Неотрицательное: Да
- Комментарий: `Стоимость ингредиента в рецепте`

**Реквизит "Комментарий":**
- Имя: `Комментарий`
- Синоним: `Способ обработки`
- Тип: Строка
- Длина: 200
- Комментарий: `Способ обработки и использования сырья`

### Шаг 2: Обновление справочника "КулинарныеРецепты"

#### 2.1. Удаление старой табличной части

1. **Откройте справочник "КулинарныеРецепты" в конфигураторе**
2. **Удалите табличную часть "СоставИнгредиентов":**
   - Найдите узел "Табличные части"
   - Выберите "СоставИнгредиентов"
   - Нажмите Delete и подтвердите удаление
   - **⚠️ ВНИМАНИЕ:** Это приведет к потере существующих данных!

#### 2.2. Добавление нового реквизита

1. **Добавьте новый реквизит "Техкарточка":**
   - Правой кнопкой на "Реквизиты" → "Добавить"
   - Имя: `Техкарточка`
   - Синоним: `Технологическая карта`
   - Тип: `СправочникСсылка.Техкарточки`
   - Проверка заполнения: Выдавать ошибку
   - Комментарий: `Ссылка на технологическую карту блюда`

#### 2.3. Обновление формы элемента

**Вариант 1: Создание формы заново (рекомендуется)**

1. **Удалите существующую форму элемента:**
   - Найдите форму элемента справочника
   - Удалите её

2. **Создайте новую форму:**
   - Правой кнопкой на справочнике → "Добавить" → "Форма"
   - Имя: `ФормаЭлемента`

3. **Настройте элементы управления:**

**Основные поля:**
- `Код` (Объект.Code)
- `Наименование` (Объект.Description)  
- `ГотовоеБлюдо` (Объект.ГотовоеБлюдо)
- `КатегорияБлюда` (Объект.КатегорияБлюда)
- `ВремяПриготовления` (Объект.ВремяПриготовления)
- `КоличествоПорций` (Объект.КоличествоПорций)

**Поле техкарточки:**
- `Техкарточка` (Объект.Техкарточка) - основное поле выбора

**Поле себестоимости:**
- `СебестоимостьПорции` (Объект.СебестоимостьПорции) - только для чтения

**Группа кнопок работы с техкарточкой:**
- Кнопка "Создать техкарточку" (СоздатьТехкарточку)
- Кнопка "Открыть техкарточку" (ОткрытьТехкарточку)

**Группа кнопок управления:**
- Кнопка "Пересчитать себестоимость" (ПересчитатьСебестоимость)

**Поле технологии:**
- `ТехнологияПриготовления` (Объект.ТехнологияПриготовления) - многострочное поле

4. **Добавьте команды формы:**

**Команда "СоздатьТехкарточку":**
- Имя: `СоздатьТехкарточку`
- Заголовок: `Создать техкарточку`
- Действие: `СоздатьТехкарточку`
- Подсказка: `Создать новую технологическую карту`

**Команда "ОткрытьТехкарточку":**
- Имя: `ОткрытьТехкарточку`
- Заголовок: `Открыть техкарточку`
- Действие: `ОткрытьТехкарточку`
- Подсказка: `Открыть выбранную технологическую карту`

**Команда "ПересчитатьСебестоимость":**
- Имя: `ПересчитатьСебестоимость`
- Заголовок: `Пересчитать себестоимость`
- Действие: `ПересчитатьСебестоимость`
- Подсказка: `Пересчитать себестоимость порции по техкарточке`

#### 2.4. Обновление модуля справочника

1. **Откройте модуль справочника "КулинарныеРецепты"**
2. **Удалите весь старый код**
3. **Скопируйте код из файла `Справочник_КулинарныеРецепты.bsl`**

**Основные процедуры в новом модуле:**

```bsl
// Обработчик изменения техкарточки
&НаКлиенте
Процедура ТехкарточкаПриИзменении(Элемент)
// Заполнение данных из техкарточки

// Команды работы с техкарточками
&НаКлиенте
Процедура СоздатьТехкарточку(Команда)
&НаКлиенте  
Процедура ОткрытьТехкарточку(Команда)

// Пересчет себестоимости
&НаКлиенте
Процедура ПересчитатьСебестоимость(Команда)

// Служебные функции
&НаСервереБезКонтекста
Функция ПолучитьДанныеТехкарточки(Техкарточка)
&НаСервереБезКонтекста
Функция РассчитатьСебестоимостьПоТехкарточке(Техкарточка)
```

**Вариант 2: Ручное обновление существующей формы**

Если вы хотите сохранить существующую форму:

1. **Удалите элементы управления табличной части:**
   - Найдите таблицу "СоставИнгредиентов"
   - Удалите её вместе с командной панелью
   - Удалите связанные команды добавления/удаления строк

2. **Добавьте новые элементы:**
   - Поле выбора техкарточки
   - Кнопки работы с техкарточками
   - Обновите обработчики событий

3. **Обновите команды формы:**
   - Удалите команды работы с табличной частью
   - Добавьте новые команды для работы с техкарточками

### Шаг 3: Создание формы для техкарточек

#### 3.1. Создание формы элемента

1. **Создайте форму элемента:**
   - Правой кнопкой на справочнике "Техкарточки" → "Добавить" → "Форма"
   - Имя формы: `ФормаЭлемента`
   - Синоним: `Форма элемента`
   - Назначение: `Для объекта`

#### 3.2. Настройка элементов управления формы

**Создайте элементы управления на форме вручную:**

1. **Добавьте элемент "Страницы":**
   - Правой кнопкой на форме → "Добавить" → "Страницы"
   - Имя: `Страницы`

2. **Создайте страницу "Основные":**
   - Правой кнопкой на "Страницы" → "Добавить" → "Страница"
   - Имя: `СтраницаОсновные`
   - Заголовок: `Основные`

3. **На странице "Основные" создайте группу "Основные реквизиты":**
   - Правой кнопкой на странице → "Добавить" → "Группа"
   - Имя: `ГруппаОсновныеРеквизиты`
   - Заголовок: `Основные реквизиты`
   - Отображение: `ОбычноеОтделение`

4. **Добавьте поля ввода в группу "Основные реквизиты":**

**Поле "Код":**
- Тип элемента: `ПолеВвода`
- Имя: `Код`
- Данные: `Объект.Code`
- Заголовок: `Код`

**Поле "Наименование":**
- Тип элемента: `ПолеВвода`
- Имя: `Наименование`
- Данные: `Объект.Description`
- Заголовок: `Наименование блюда`

**Поле "НомерТехкарточки":**
- Тип элемента: `ПолеВвода`
- Имя: `НомерТехкарточки`
- Данные: `Объект.НомерТехкарточки`
- Заголовок: `Номер техкарточки`

**Поле "ГотовоеБлюдо":**
- Тип элемента: `ПолеВвода`
- Имя: `ГотовоеБлюдо`
- Данные: `Объект.ГотовоеБлюдо`
- Заголовок: `Готовое блюдо`

**Поле "КатегорияБлюда":**
- Тип элемента: `ПолеВвода`
- Имя: `КатегорияБлюда`
- Данные: `Объект.КатегорияБлюда`
- Заголовок: `Категория блюда`

**Поле "ВремяПриготовления":**
- Тип элемента: `ПолеВвода`
- Имя: `ВремяПриготовления`
- Данные: `Объект.ВремяПриготовления`
- Заголовок: `Время приготовления (мин)`

5. **Создайте группу "Выход и пищевая ценность":**
   - Правой кнопкой на странице → "Добавить" → "Группа"
   - Имя: `ГруппаПоказатели`
   - Заголовок: `Выход и пищевая ценность`
   - Группировка: `ВсегдаГоризонтальная`

6. **В группе "Показатели" создайте подгруппы:**

**Подгруппа "Выход":**
- Имя: `ГруппаВыход`
- Добавьте поля:
  - `ВыходПорции` (Объект.ВыходПорции) - "Выход порции (г)"
  - `СебестоимостьПорции` (Объект.СебестоимостьПорции) - "Себестоимость порции" (только чтение)

**Подгруппа "Пищевая ценность":**
- Имя: `ГруппаПищеваяЦенность`
- Добавьте поля:
  - `КалорийностьПорции` (Объект.КалорийностьПорции) - "Калорийность (ккал)"
  - `Белки` (Объект.Белки) - "Белки (г)"
  - `Жиры` (Объект.Жиры) - "Жиры (г)"
  - `Углеводы` (Объект.Углеводы) - "Углеводы (г)"

7. **Добавьте кнопки управления:**
   - `ПересчитатьСебестоимость` - "Пересчитать себестоимость"
   - `РассчитатьПищевуюЦенность` - "Рассчитать пищевую ценность"

#### 3.3. Создание страницы "Состав ингредиентов"

1. **Создайте вторую страницу:**
   - Имя: `СтраницаИнгредиенты`
   - Заголовок: `Состав ингредиентов`

2. **Добавьте таблицу:**
   - Тип элемента: `Таблица`
   - Имя: `СоставИнгредиентов`
   - Данные: `Объект.СоставИнгредиентов`
   - Заголовок: `Нормы вложения сырья и продуктов`

3. **Настройте колонки таблицы:**
   - Номер строки (только чтение, ширина 3)
   - Ингредиент (ширина 25)
   - Норма брутто (ширина 12)
   - % отходов (ширина 8)
   - Норма нетто (ширина 12)
   - Цена за кг (только чтение, ширина 10)
   - Сумма (только чтение, ширина 10)
   - Способ обработки (ширина 20)

4. **Добавьте командную панель с кнопками:**
   - "Добавить" (СоставИнгредиентовДобавить)
   - "Удалить" (СоставИнгредиентовУдалить)

#### 3.4. Создание страницы "Технология"

1. **Создайте третью страницу:**
   - Имя: `СтраницаТехнология`
   - Заголовок: `Технология`

2. **Добавьте многострочные поля:**

**Поле "ТехнологияПриготовления":**
- Тип: `ПолеВвода`
- Данные: `Объект.ТехнологияПриготовления`
- Многострочность: Да
- Расширенное редактирование: Да
- Высота: 8
- Растягивание по вертикали: Да

**Поле "ТребованияКСырью":**
- Тип: `ПолеВвода`
- Данные: `Объект.ТребованияКСырью`
- Многострочность: Да
- Расширенное редактирование: Да
- Высота: 4

**Поле "ПоказателиГотовогоБлюда":**
- Тип: `ПолеВвода`
- Данные: `Объект.ПоказателиГотовогоБлюда`
- Многострочность: Да
- Расширенное редактирование: Да
- Высота: 4

#### 3.5. Создание команд формы

**В дереве конфигурации найдите "Команды" формы и добавьте:**

1. **Команда "ПересчитатьСебестоимость":**
   - Имя: `ПересчитатьСебестоимость`
   - Заголовок: `Пересчитать себестоимость`
   - Действие: `ПересчитатьСебестоимость`

2. **Команда "РассчитатьПищевуюЦенность":**
   - Имя: `РассчитатьПищевуюЦенность`
   - Заголовок: `Рассчитать пищевую ценность`
   - Действие: `РассчитатьПищевуюЦенность`

3. **Команда "СоставИнгредиентовДобавить":**
   - Имя: `СоставИнгредиентовДобавить`
   - Заголовок: `Добавить`
   - Действие: `СоставИнгредиентовДобавить`

4. **Команда "СоставИнгредиентовУдалить":**
   - Имя: `СоставИнгредиентовУдалить`
   - Заголовок: `Удалить`
   - Действие: `СоставИнгредиентовУдалить`

#### 3.6. Добавление модуля формы

1. **Правой кнопкой на форме → "Модуль" → "Открыть модуль формы"**
2. **Скопируйте код из файла `Справочник_Техкарточки.bsl`** в модуль формы

### Шаг 4: Проверка перечисления "КатегорииБлюд"

1. **Проверьте наличие перечисления** в узле "Перечисления"
2. **Если его нет, создайте новое перечисление:**
   - Имя: `КатегорииБлюд`
   - Синоним: `Категории блюд`

3. **Добавьте значения:**
   - Супы
   - Вторые блюда
   - Гарниры
   - Салаты
   - Десерты
   - Напитки
   - Выпечка
   - Горячие закуски
   - Холодные закуски

### Шаг 5: Создание регистра "ПриготовлениеПоРецептам"

1. **Создайте новый регистр сведений:**
   - Имя: `ПриготовлениеПоРецептам`
   - Синоним: `Приготовление по рецептам`
   - Вид регистра: `РегистрСведений`

2. **Добавьте измерения:**
   - ДатаВремя (Дата) - **НЕ используйте "Период"** в украинской версии!
   - Рецепт (СправочникСсылка.КулинарныеРецепты)
   - ГотовоеБлюдо (СправочникСсылка.Номенклатуры)
   - Ингредиент (СправочникСсылка.Номенклатуры)

3. **Добавьте ресурсы:**
   - КоличествоПорций (Число 10.3)
   - КоличествоИнгредиента (Число 15.3)
   - СтоимостьИнгредиента (Число 15.2)
   - СкладСырья (СправочникСсылка.Склады)
   - СкладГотовойПродукции (СправочникСсылка.Склады)

4. **Скопируйте код из файла `РегистрСведений_ПриготовлениеПоРецептам.bsl`** в модуль регистра


### Шаг 6: Создание документа "Приготовление блюда"

1. **Создайте новый документ:**
   - Имя: `ПриготовлениеБлюда`
   - Синоним: `Приготовление блюда`
   - Комментарий: `Документ для учета приготовления готовых блюд`

2. **Добавьте реквизиты документа:**

**Реквизит "СкладСырья":**
- Имя: `СкладСырья`
- Синоним: `Склад сырья`
- Тип: СправочникСсылка.Склады
- Проверка заполнения: Выдавать ошибку
- Комментарий: `Склад для списания ингредиентов`

**Реквизит "СкладГотовойПродукции":**
- Имя: `СкладГотовойПродукции`
- Синоним: `Склад готовой продукции`
- Тип: СправочникСсылка.Склады
- Проверка заполнения: Выдавать ошибку
- Комментарий: `Склад для оприходования готовых блюд`


3. **Создайте табличную часть "ПриготавливаемыеБлюда":**

**Реквизит "Блюдо":**
- Имя: `Блюдо`
- Синоним: `Блюдо`
- Тип: СправочникСсылка.Номенклатура
- Проверка заполнения: Выдавать ошибку

**Реквизит "КоличествоПорций":**
- Имя: `КоличествоПорций`
- Синоним: `Количество порций`
- Тип: Число 10.3
- Проверка заполнения: Выдавать ошибку

**Реквизит "ПлановаяСебестоимостьПорции":**
- Имя: `ПлановаяСебестоимостьПорции`
- Синоним: `Плановая себестоимость порции`
- Тип: Число 15.2

**Реквизит "ОбщаяПлановаяСебестоимость":**
- Имя: `ОбщаяПлановаяСебестоимость`
- Синоним: `Общая плановая себестоимость`
- Тип: Число 15.2

4. **Скопируйте код из файла `Документ_ПриготовлениеБлюда.bsl`** в модуль документа

5. **Создайте форму документа:**
   - Скопируйте код из файла `Форма_ПриготовлениеБлюда.bsl`
   - Настройте элементы управления согласно инструкции в файле

Шаг 1: Создание формы в конфигураторе

  1.1 Создание формы

  1. В дереве конфигурации найдите документ "ПриготовлениеБлюда"
  2. Правой кнопкой на документе → "Добавить" → "Форма"
  3. Заполните свойства формы:
    - Имя: ФормаДокумента
    - Синоним: Форма документа
    - Назначение: Для объекта

  1.2 Настройка основных свойств

  - Тип формы: Управляемая
  - Использовать стандартные команды: Да

  Шаг 2: Создание элементов управления

  2.1 Создание группы "Шапка"

  1. Правой кнопкой на форме → "Добавить" → "Группа"
  2. Свойства группы:
    - Имя: ГруппаШапка
    - Заголовок: Основные данные
    - Вид: ОбычноеОтделение
    - Группировка элементов: Вертикальная

  2.2 Добавление полей в шапку

  Добавьте в группу "ГруппаШапка" поля ввода:

  Поле "Номер":
  - Правой кнопкой на ГруппаШапка → "Добавить" → "Поле"
  - Имя: Номер
  - Путь к данным: Объект.Номер
  - Вид: ПолеВвода

  Поле "Дата":
  - Имя: Дата
  - Путь к данным: Объект.Дата
  - Вид: ПолеВвода

  Поле "СкладСырья":
  - Имя: СкладСырья
  - Путь к данным: Объект.СкладСырья
  - Вид: ПолеВвода
  - Заголовок: Склад сырья

  Поле "СкладГотовойПродукции":
  - Имя: СкладГотовойПродукции
  - Путь к данным: Объект.СкладГотовойПродукции
  - Вид: ПолеВвода
  - Заголовок: Склад готовой продукции

  2.3 Создание табличной части

  1. Правой кнопкой на форме → "Добавить" → "Таблица"
  2. Свойства таблицы:
    - Имя: ПриготавливаемыеБлюда
    - Путь к данным: Объект.ПриготавливаемыеБлюда
    - Заголовок: Приготавливаемые блюда

  2.4 Настройка колонок таблицы

  Добавьте колонки в таблицу:

  1. Правой кнопкой на таблице → "Добавить" → "Поле"

  Колонка "Блюдо":
  - Имя: ПриготавливаемыеБлюдаБлюдо
  - Путь к данным: Объект.ПриготавливаемыеБлюда.Блюдо
  - Заголовок: Блюдо
  - Ширина: 25

  Колонка "КоличествоПорций":
  - Имя: ПриготавливаемыеБлюдаКоличествоПорций
  - Путь к данным: Объект.ПриготавливаемыеБлюда.КоличествоПорций       
  - Заголовок: Количество порций
  - Ширина: 12

  Колонка "ПлановаяСебестоимостьПорции":
  - Имя: ПриготавливаемыеБлюдаПлановаяСебестоимостьПорции
  - Путь к данным:
  Объект.ПриготавливаемыеБлюда.ПлановаяСебестоимостьПорции
  - Заголовок: Себестоимость порции
  - Ширина: 15
  - Только просмотр: Истина

  Колонка "ОбщаяПлановаяСебестоимость":
  - Имя: ПриготавливаемыеБлюдаОбщаяПлановаяСебестоимость
  - Путь к данным:
  Объект.ПриготавливаемыеБлюда.ОбщаяПлановаяСебестоимость
  - Заголовок: Себестоимость порции
  - Ширина: 15
  - Только просмотр: Истина

  Шаг 3: Создание команд формы

  3.1 Добавление команд

  1. В дереве формы найдите узел "Команды"
  2. Правой кнопкой на "Команды" → "Добавить"

  Команда "ПроверитьНаличиеИнгредиентов":
  - Имя: ПроверитьНаличиеИнгредиентов
  - Заголовок: Проверить наличие ингредиентов
  - Действие: ПроверитьНаличиеИнгредиентов

  Команда "ЗаполнитьПоОстаткам":
  - Имя: ЗаполнитьПоОстаткам
  - Заголовок: Заполнить по остаткам
  - Действие: ЗаполнитьПоОстаткам

  Команда "ПоказатьСоставИнгредиентов":
  - Имя: ПоказатьСоставИнгредиентов
  - Заголовок: Показать состав ингредиентов
  - Действие: ПоказатьСоставИнгредиентов

  3.2 Размещение кнопок

  1. Создайте командную панель:
    - Правой кнопкой на форме → "Добавить" → "КоманднаяПанель"
    - Имя: КоманднаяПанельФормы
  2. Добавьте кнопки на панель:
    - Правой кнопкой на командной панели → "Добавить" → "Кнопка"       
    - Для каждой команды создайте кнопку, указав соответствующую       
  команду

  Шаг 4: Создание модуля формы

  4.1 Создание модуля

  1. Правой кнопкой на форме → "Модуль" → "Открыть модуль формы"       
  2. Скопируйте весь код из файла Форма_ПриготовлениеБлюда.bsl
  3. Вставьте код в модуль формы

  4.2 Настройка обработчиков событий

  Свяжите элементы формы с обработчиками:

  1. Для поля "СкладСырья":
    - Свойства → События → ПриИзменении: СкладСырьяПриИзменении        
  2. Для поля "СкладГотовойПродукции":
    - События → ПриИзменении: СкладГотовойПродукцииПриИзменении        
  3. Для таблицы "ПриготавливаемыеБлюда":
    - События → ПриИзменении: ПриготавливаемыеБлюдаПриИзменении        
    - События → ПриАктивизацииСтроки:
  ПриготавливаемыеБлюдаПриАктивизацииСтроки
  4. Для колонки "Блюдо":
    - События → ПриИзменении:
  ПриготавливаемыеБлюдаБлюдоПриИзменении
  5. Для колонки "КоличествоПорций":
    - События → ПриИзменении:
  ПриготавливаемыеБлюдаКоличествоПорцийПриИзменении

  Шаг 5: Финальная настройка

  5.1 Порядок обхода

  Настройте порядок перехода по полям:
  1. Номер → Дата → СкладСырья → СкладГотовойПродукции → Таблица       

  5.2 Горячие клавиши

  Назначьте горячие клавиши для команд:
  - ПроверитьНаличиеИнгредиентов: Ctrl+F5
  - ЗаполнитьПоОстаткам: Ctrl+F6
  - ПоказатьСоставИнгредиентов: Ctrl+F7

  5.3 Проверка формы

  1. Сохраните все изменения (Ctrl+S)
  2. Проверьте синтаксис модуля формы
  3. Обновите конфигурацию базы данных

  Результат:

  После выполнения всех шагов у вас будет полнофункциональная форма    
   документа с:
  - ✅ Удобным интерфейсом для ввода данных
  - ✅ Автоматическим расчетом себестоимости
  - ✅ Проверкой наличия ингредиентов
  - ✅ Автозаполнением по остаткам
  - ✅ Показом состава ингредиентов

### Шаг 7: Сохранение и обновление конфигурации

1. **Сохраните все изменения** (Ctrl+S)
2. **Обновите конфигурацию базы данных:**
   - Меню "Конфигурация" → "Обновить конфигурацию базы данных"
   - Дождитесь завершения процесса
   - При появлении предупреждений о структурных изменениях нажмите "Продолжить"

3. **Проверьте отсутствие ошибок:**
   - Меню "Сервис" → "Синтаксический контроль"
   - Все ошибки должны быть устранены

---

## НАСТРОЙКА СПРАВОЧНИКА НОМЕНКЛАТУРЫ

### Создание видов номенклатуры

1. **Откройте справочник "ВидыНоменклатуры"** (если используется)
2. **Создайте вид "Готовые блюда":**
   - Код: `БЛЮДА`
   - Наименование: `Готовые блюда`
   - Описание: `Готовые к продаже блюда из меню`

3. **Создайте вид "Ингредиенты":**
   - Код: `ИНГР`
   - Наименование: `Ингредиенты`
   - Описание: `Сырье и продукты для приготовления блюд`

### Настройка номенклатуры готовых блюд

Для каждого блюда в меню создайте элемент номенклатуры:

1. **Откройте справочник "Номенклатура"**
2. **Создайте группу "Готовые блюда"** (если нужно)
3. **Для каждого блюда создайте элемент:**

**Пример: Борщ украинский**
- Код: `БОРЩ001`
- Наименование: `Борщ украинский`
- Вид номенклатуры: `Готовые блюда`
- Единица измерения: `порция`
- НДС: согласно учетной политике
- Описание: `Традиционный украинский борщ с мясом`

**Важные моменты:**
- ✅ Используйте понятные коды
- ✅ Наименования должны точно соответствовать меню
- ✅ Обязательно указывайте единицы измерения
- ✅ Заполняйте описания для удобства поиска

### Настройка номенклатуры ингредиентов

Создайте элементы для всех используемых продуктов:

**Категории ингредиентов:**
1. **Мясо и птица** (говядина, свинина, курица, и т.д.)
2. **Рыба и морепродукты**
3. **Овощи** (картофель, морковь, лук, и т.д.)
4. **Молочные продукты** (молоко, сметана, творог, и т.д.)
5. **Крупы и макароны**
6. **Специи и приправы**
7. **Масла и жиры**
8. **Консервы и полуфабрикаты**

**Пример настройки ингредиента:**
- Код: `ГОВЯД001`
- Наименование: `Говядина (мякоть)`
- Вид номенклатуры: `Ингредиенты`
- Базовая единица: `кг`
- Дополнительные единицы: `г` (коэффициент 0.001)

**Рекомендации по настройке:**
- 📝 Ведите единообразную систему кодирования
- 📝 Все весовые ингредиенты - в килограммах и граммах
- 📝 Жидкости - в литрах и миллилитрах
- 📝 Используйте понятные сокращения в кодах
- 📝 Группируйте ингредиенты по категориям

### Настройка цен ингредиентов

1. **Заполните цены поступления:**
   - Откройте карточку ингредиента
   - Перейдите на вкладку "Цены"
   - Укажите текущие цены от поставщиков

2. **Настройте автоматическое обновление цен:**
   - При создании документов поступления цены будут обновляться автоматически
   - Система будет использовать последние цены для расчета себестоимости

---

## СОЗДАНИЕ И НАСТРОЙКА ТЕХКАРТОЧЕК

### Подготовка к созданию техкарточек

1. **Соберите необходимую информацию для каждого блюда:**
   - Выход готового блюда (в граммах)
   - Список всех ингредиентов
   - Количество ингредиентов (брутто и нетто)
   - Процент отходов при обработке
   - Время приготовления
   - Технология приготовления
   - Пищевая ценность (если известна)

### Создание первой техкарточки (пошаговый пример)

**Создадим техкарточку для "Борща украинского":**

#### Шаг 1: Создание элемента
1. **Откройте справочник "Технологические карты"**
2. **Нажмите "Создать"**
3. **Заполните основные реквизиты:**
   - Наименование: `Борщ украинский`
   - Номер техкарточки: `ТК-001`
   - Готовое блюдо: выберите из номенклатуры `Борщ украинский`
   - Категория блюда: `Супы`

#### Шаг 2: Заполнение показателей блюда
1. **Перейдите на страницу "Основные"**
2. **Заполните показатели:**
   - Выход порции: `250` г
   - Время приготовления: `90` мин
   - Калорийность порции: `180` ккал (примерно)
   - Белки: `8.5` г
   - Жиры: `12.0` г
   - Углеводы: `10.5` г

#### Шаг 3: Добавление ингредиентов
1. **Перейдите на страницу "Состав ингредиентов"**
2. **Добавьте каждый ингредиент:**

**Ингредиент 1: Говядина**
- Наименование сырья: `Говядина (мякоть)`
- Норма брутто: `80` г
- Процент отходов: `0` %
- Норма нетто: `80` г (автоматически)
- Способ обработки: `Отварить до готовности`

**Ингредиент 2: Картофель**
- Наименование сырья: `Картофель`
- Норма брутто: `50` г
- Процент отходов: `25` % (чистка)
- Норма нетто: `37.5` г (автоматически)
- Способ обработки: `Очистить, нарезать кубиками`

**Ингредиент 3: Морковь**
- Наименование сырья: `Морковь`
- Норма брутто: `30` г
- Процент отходов: `20` %
- Норма нетто: `24` г
- Способ обработки: `Очистить, натереть на терке`

**Ингредиент 4: Лук репчатый**
- Наименование сырья: `Лук репчатый`
- Норма брутто: `25` г
- Процент отходов: `16` %
- Норма нетто: `21` г
- Способ обработки: `Очистить, нарезать кубиками`

**...и так далее для всех ингредиентов**

#### Шаг 4: Описание технологии
1. **Перейдите на страницу "Технология"**
2. **Заполните технологию приготовления:**

```
ТЕХНОЛОГИЯ ПРИГОТОВЛЕНИЯ:

1. Мясо нарезать кусочками, залить холодной водой, довести до кипения, снять пену.
2. Варить мясо 1-1.5 часа до готовности.
3. Овощи очистить и нарезать: картофель - кубиками, морковь - соломкой, лук - кубиками.
4. Свеклу натереть на крупной терке, тушить с томатной пастой 10 минут.
5. В кипящий бульон добавить картофель, варить 10 минут.
6. Добавить морковь, лук, тушеную свеклу.
7. Варить до готовности овощей 15-20 минут.
8. За 5 минут до готовности добавить специи, лавровый лист.
9. Довести до вкуса солью и перцем.
```

3. **Заполните требования к сырью:**
```
ТРЕБОВАНИЯ К КАЧЕСТВУ СЫРЬЯ:

- Мясо говяжье - свежее, без постороннего запаха
- Овощи - свежие, без признаков порчи
- Томатная паста - ГОСТ, концентрация 25-30%
- Специи - в герметичной упаковке, не просроченные
```

4. **Заполните показатели готового блюда:**
```
ПОКАЗАТЕЛИ ГОТОВОГО БЛЮДА:



```

#### Шаг 5: Расчет себестоимости
1. **Нажмите кнопку "Пересчитать себестоимость"**
2. **Система автоматически:**
   - Подтянет текущие цены ингредиентов
   - Рассчитает стоимость каждого ингредиента
   - Вычислит общую себестоимость порции

#### Шаг 6: Расчет пищевой ценности
1. **Нажмите кнопку "Рассчитать пищевую ценность"**
2. **Если в системе настроены данные о БЖУ ингредиентов:**
   - Система автоматически рассчитает пищевую ценность
   - При отсутствии данных введите значения вручную

### Создание техкарточек для разных категорий блюд

#### Особенности для супов:
- Учитывайте объем бульона
- Указывайте время варки мяса/костей
- Не забывайте про специи и зелень

#### Особенности для вторых блюд:
- Отдельно указывайте гарнир и основное блюдо
- Учитывайте способы тепловой обработки
- Контролируйте потери при жарке/тушении

#### Особенности для салатов:
- Минимальные потери при обработке
- Учитывайте заправки и соусы
- Контролируйте сроки хранения компонентов

#### Особенности для выпечки:
- Учитывайте потери при выпекании
- Контролируйте влажность теста
- Указывайте температуру и время выпекания

### Проверка и корректировка техкарточек

После создания каждой техкарточки:

1. **Проверьте математическую точность:**
   - Сумма норм брутто-нетто должна соответствовать процентам отходов
   - Выход готового блюда должен быть реалистичным

2. **Сверьте с фактическими данными:**
   - Попросите поваров приготовить блюдо по техкарточке
   - Сравните фактический выход с расчетным
   - При необходимости скорректируйте нормы

3. **Проверьте экономическую эффективность:**
   - Сравните себестоимость с продажной ценой
   - Убедитесь в достаточной рентабельности

---

## РАБОТА С КУЛИНАРНЫМИ РЕЦЕПТАМИ

### Создание рецепта на основе техкарточки

После создания техкарточки необходимо создать кулинарный рецепт:

#### Шаг 1: Создание рецепта
1. **Откройте справочник "Кулинарные рецепты"**
2. **Нажмите "Создать"**
3. **Заполните основные данные:**
   - Наименование: `Борщ украинский` (как в техкарточке)
   - Готовое блюдо: выберите из номенклатуры
   - Технологическая карта: выберите созданную техкарточку
   - Количество порций: `1` (базовая порция)

#### Шаг 2: Автоматическое заполнение
После выбора техкарточки система автоматически заполнит:
- Категорию блюда
- Время приготовления
- Технологию приготовления
- Себестоимость порции

#### Шаг 3: Корректировка (при необходимости)
- Если рецепт рассчитан на несколько порций, измените количество порций
- Система автоматически пересчитает себестоимость

### Создание вариантов рецептов

Для одной техкарточки можно создать несколько рецептов:

**Пример:**
- Техкарточка: "Борщ украинский" (1 порция)
- Рецепт 1: "Борщ украинский" (1 порция) - для кафе
- Рецепт 2: "Борщ украинский большая порция" (1.5 порции) - для ресторана
- Рецепт 3: "Борщ украинский котел" (20 порций) - для банкетов

### Обновление рецептов при изменении техкарточек

При изменении техкарточки:
1. **Откройте связанные рецепты**
2. **Нажмите "Пересчитать себестоимость"**
3. **Система обновит данные** из техкарточки
4. **Проверьте актуальность** количества порций

---

## ДОКУМЕНТ "ПРИГОТОВЛЕНИЕ БЛЮДА"

### Назначение и принципы работы

**Документ "Приготовление блюда"** - это ключевой элемент новой архитектуры системы, который разделяет процессы приготовления и продажи блюд.

#### Основные принципы:
1. **Разделение процессов** - приготовление блюд происходит отдельно от их продажи
2. **Контроль запасов** - формирование и учет запасов готовых блюд
3. **Точный учет себестоимости** - фиксация фактических затрат на момент приготовления
4. **Аналитический учет** - детальная статистика по приготовлению

### Создание документа приготовления

#### Шаг 1: Заполнение шапки документа
1. **Откройте документ "Приготовление блюда"**
2. **Заполните основные реквизиты:**
   - Дата и время приготовления
   - Склад сырья (откуда списывать ингредиенты)
   - Склад готовой продукции (куда оприходовать готовые блюда)
   - Повар (ответственный за приготовление)

#### Шаг 2: Добавление блюд для приготовления
1. **В табличной части "Приготавливаемые блюда":**
   - Выберите блюдо из номенклатуры
   - Укажите количество порций для приготовления
   - Система автоматически рассчитает плановую себестоимость

#### Шаг 3: Проверка наличия ингредиентов
1. **Нажмите кнопку "Проверить наличие ингредиентов"**
2. **Система покажет:**
   - ✅ Доступные ингредиенты с указанием количества
   - ❌ Недостающие ингредиенты с указанием нехватки
   - ⚠ Предупреждения о критических остатках

**Пример результата проверки:**
```
✅ Говядина (мякоть) - требуется 0.80 кг, доступно 2.50 кг
✅ Картофель - требуется 0.50 кг, доступно 5.00 кг  
❌ Морковь - требуется 0.30 кг, доступно 0.15 кг (недостаток 0.15 кг)
✅ Лук репчатый - требуется 0.25 кг, доступно 1.20 кг
```

### Автоматические функции

#### Заполнение по остаткам
**Кнопка "Заполнить по остаткам"** автоматически:
1. Анализирует остатки готовых блюд на складе
2. Выявляет блюда с низкими остатками (≤ 5 порций)
3. Предлагает приготовить недостающее количество
4. Рассчитывает оптимальные объемы для пополнения

#### Показ состава ингредиентов
**Кнопка "Показать состав ингредиентов":**
1. Отображает полный состав выбранного блюда
2. Показывает количество ингредиентов с учетом порций
3. Рассчитывает общую стоимость ингредиентов

**Пример вывода:**
```
Состав ингредиентов для блюда "Борщ украинский" (10 порций):
• Говядина (мякоть): 0.80 кг (стоимость 480.00 руб.)
• Картофель: 0.50 кг (стоимость 25.00 руб.)
• Морковь: 0.30 кг (стоимость 18.00 руб.)
• Лук репчатый: 0.25 кг (стоимость 12.50 руб.)
...
Общая плановая себестоимость: 895.50 руб.
```

### Проведение документа

При проведении документа система выполняет:

#### Движения по регистру "ТоварыНаСкладах":
1. **Приход готовых блюд** на склад готовой продукции
2. **Расход ингредиентов** со склада сырья

#### Движения по регистру "ПриготовлениеПоРецептам":
- Детальная аналитика по каждому ингредиенту
- Связь с конкретным рецептом и поваром
- Фиксация фактических затрат и времени

#### Контроль при проведении:
- **Проверка наличия рецептов** для всех блюд
- **Контроль остатков ингредиентов** на складе сырья
- **Валидация норм расхода** по техкарточкам

### Ежедневное использование

#### Для поваров:
1. **Планирование смены:**
   - Создать документ приготовления
   - Заполнить по остаткам или вручную добавить блюда
   - Проверить наличие ингредиентов

2. **Во время приготовления:**
   - Следовать техкарточкам
   - Контролировать нормы вложения
   - Фиксировать фактические выходы

3. **После приготовления:**
   - Провести документ
   - Разместить готовые блюда на складе

#### Для менеджеров кухни:
1. **Контроль производства:**
   - Анализ загрузки поваров
   - Контроль соблюдения рецептур
   - Планирование объемов производства

2. **Управление остатками:**
   - Мониторинг остатков готовых блюд
   - Планирование дополнительного производства
   - Контроль сроков годности

#### Для снабжения:
1. **Планирование закупок:**
   - Анализ потребления ингредиентов
   - Прогнозирование будущих потребностей
   - Контроль эффективности использования

### Отчеты и аналитика

#### Встроенные отчеты регистра "ПриготовлениеПоРецептам":
1. **Статистика расхода ингредиентов** - топ используемых продуктов
2. **Статистика приготовленных блюд** - популярность блюд по объемам
3. **Эффективность поваров** - производительность и качество работы
4. **Сравнение плана и факта** - анализ отклонений от нормативов

#### Пример анализа отклонений:
```
Анализ отклонений по блюду "Борщ украинский":
План: Морковь 0.24 кг на порцию
Факт: Морковь 0.26 кг на порцию  
Отклонение: +8.3% (перерасход)

Возможные причины:
- Высокий процент отходов у данной партии моркови
- Нарушение технологии нарезки
- Необходимость корректировки техкарточки
```

### Преимущества раздельной схемы

#### Для учета:
- **Точная себестоимость** готовых блюд на момент приготовления
- **Контроль запасов** готовой продукции
- **Простота продаж** - списание только готовых блюд

#### Для производства:
- **Планирование производства** независимо от продаж
- **Контроль качества** на этапе приготовления  
- **Оптимизация загрузки** кухни

#### Для управления:
- **Разделение ответственности** между кухней и залом
- **Независимый контроль** процессов производства и продаж
- **Детальная аналитика** по всем этапам

### Интеграция с другими документами

#### Связь с планированием:
- Документы планирования производства
- Заявки на приготовление от зала
- Прогнозы продаж

#### Связь с закупками:
- Автоматический расчет потребности в ингредиентах
- Планирование закупок на основе производственных планов
- Контроль выполнения планов поставок

---

## ИНТЕГРАЦИЯ С ДОКУМЕНТАМИ ПРОДАЖ

### Новая архитектура продаж

**В новой системе процесс продажи кардинально упрощается:**

#### Старая схема (списание ингредиентов при продаже):
```
Продажа блюда → Поиск рецепта → Расчет ингредиентов → Списание ингредиентов
```

#### Новая схема (списание готовых блюд):
```
Приготовление → Списание ингредиентов → Оприходование готовых блюд
        ↓
Продажа блюда → Списание готового блюда
```

### Принцип интеграции

**Используйте только документ "Приготовление блюда" без изменения документов продаж**

**Преимущества:**
- Максимальная простота продаж
- Независимость процессов производства и продаж
- Отсутствие влияния на существующую логику продаж

**Настройка:**
1. Создайте документ "Приготовление блюда"
2. Документы продаж работают как обычно (списывают готовые блюда из номенклатуры)
3. Никаких изменений в модулях продаж не требуется

### Настройка интеграции

#### Шаг 1: Обеспечьте наличие готовых блюд на складе
1. **Используйте документ "Приготовление блюда"** для формирования запасов
2. **Готовые блюда должны быть в наличии** на складе готовой продукции
3. **Документы продаж списывают только готовые блюда**

#### Шаг 2: Настройте контроль остатков в продажах
В модуле документа продаж добавьте проверку остатков готовых блюд:

```bsl
Процедура ОбработкаПроведения(Отказ, РежимПроведения)
    
    // Существующий код проведения документа
    // ...
    
    // Проверяем наличие готовых блюд на складе
    ПроверитьНаличиеГотовыхБлюд(Отказ);
    
КонецПроцедуры

Процедура ПроверитьНаличиеГотовыхБлюд(Отказ)
    
    Для Каждого СтрокаТовара Из Товары Цикл
        
        Если ЗначениеЗаполнено(СтрокаТовара.Номенклатура) И СтрокаТовара.Количество > 0 Тогда
            
            // Проверяем, является ли это готовым блюдом (имеет рецепт)
            Если ИмеетРецепт(СтрокаТовара.Номенклатура) Тогда
                
                ОстатокНаСкладе = ПолучитьОстатокНоменклатурыНаСкладе(
                    СтрокаТовара.Номенклатура, 
                    Склад, 
                    Дата
                );
                
                Если ОстатокНаСкладе < СтрокаТовара.Количество Тогда
                    
                    ТекстСообщения = СтрШаблон(
                        "Недостаточно готового блюда ""%1"" на складе ""%2"". 
                        |Требуется: %3, доступно: %4",
                        СтрокаТовара.Номенклатура,
                        Склад,
                        СтрокаТовара.Количество,
                        ОстатокНаСкладе
                    );
                    
                    Сообщение = Новый СообщениеПользователю;
                    Сообщение.Текст = ТекстСообщения;
                    Сообщение.Сообщить();
                    
                    Отказ = Истина;
                    
                КонецЕсли;
                
            КонецЕсли;
            
        КонецЕсли;
        
    КонецЦикла;
    
КонецПроцедуры

Функция ИмеетРецепт(Блюдо)
    
    Запрос = Новый Запрос;
    Запрос.Текст = 
    "ВЫБРАТЬ ПЕРВЫЕ 1
    |    КулинарныеРецепты.Ссылка
    |ИЗ
    |    Справочник.КулинарныеРецепты КАК КулинарныеРецепты
    |ГДЕ
    |    КулинарныеРецепты.ГотовоеБлюдо = &ГотовоеБлюдо
    |    И НЕ КулинарныеРецепты.ПометкаУдаления";
    
    Запрос.УстановитьПараметр("ГотовоеБлюдо", Блюдо);
    
    Возврат НЕ Запрос.Выполнить().Пустой();
    
КонецФункции
```


### Рекомендуемый сценарий внедрения

#### Этап 1: Подготовка (1-2 дня)
1. Внедрите документ "Приготовление блюда"
2. Создайте техкарточки для основных блюд
3. Настройте рецепты

#### Этап 2: Тестирование (1-2 недели)
1. Используйте документ "Приготовление блюда" для формирования запасов
2. Тестируйте продажи готовых блюд
3. Проверяйте корректность остатков и движений

#### Этап 3: Запуск (1 день)
1. Обучите персонал работе с новым документом
2. Запустите полноценную работу
3. Настройте мониторинг остатков готовых блюд

### Мониторинг и контроль

#### Ключевые показатели для контроля:
1. **Остатки готовых блюд** - не допускайте нулевых остатков популярных блюд
2. **Время приготовления** - планируйте производство заранее
3. **Сроки годности** - контролируйте свежесть готовых блюд
4. **Загрузка кухни** - оптимизируйте график приготовления

#### Настройка уведомлений:
```bsl
// Пример проверки критических остатков готовых блюд
Функция ПроверитьКритическиеОстатки()
    
    Запрос = Новый Запрос;
    Запрос.Текст = 
    "ВЫБРАТЬ
    |    ТоварыНаСкладахОстатки.Номенклатура КАК Блюдо,
    |    ТоварыНаСкладахОстатки.КоличествоОстаток КАК Остаток
    |ИЗ
    |    РегистрНакопления.ТоварыНаСкладах.Остатки(
    |        &НаДату,
    |        Номенклатура В (
    |            ВЫБРАТЬ РАЗЛИЧНЫЕ
    |                КулинарныеРецепты.ГотовоеБлюдо
    |            ИЗ
    |                Справочник.КулинарныеРецепты КАК КулинарныеРецепты
    |            ГДЕ
    |                НЕ КулинарныеРецепты.ПометкаУдаления
    |        )
    |    ) КАК ТоварыНаСкладахОстатки
    |ГДЕ
    |    ТоварыНаСкладахОстатки.КоличествоОстаток <= 3";
    
    Запрос.УстановитьПараметр("НаДату", ТекущаяДата());
    
    КритическиеОстатки = Запрос.Выполнить().Выгрузить();
    
    Если КритическиеОстатки.Количество() > 0 Тогда
        // Отправить уведомление поварам и менеджерам
        УведомитьОКритическихОстатках(КритическиеОстатки);
    КонецЕсли;
    
КонецФункции
```

### Преимущества новой схемы продаж

#### Для кассиров и официантов:
- **Простота работы** - никаких изменений в процессе продаж
- **Быстрое проведение** документов (нет сложных расчетов)
- **Понятные сообщения** об ошибках ("нет блюда" вместо "нет ингредиента")

#### Для менеджмента:
- **Контроль запасов** готовой продукции
- **Планирование производства** независимо от продаж
- **Оптимизация работы** кухни и зала

#### Для учета:
- **Точная себестоимость** фиксируется при приготовлении
- **Простые движения** по регистрам при продажах
- **Разделение аналитики** производства и продаж

---

## ТЕСТИРОВАНИЕ СИСТЕМЫ

### Подготовка к тестированию

1. **Создайте тестовые данные:**
   - Минимум 3-5 техкарточек
   - Соответствующие рецепты
   - Остатки ингредиентов на складе

2. **Подготовьте тестовые сценарии:**
   - Продажа одного блюда
   - Продажа нескольких разных блюд
   - Продажа блюда при недостатке ингредиентов
   - Отмена проведения документа продажи

### Тест 1: Продажа одного блюда

1. **Создайте документ продажи**
2. **Добавьте одно блюдо** (например, "Борщ украинский", 2 порции)
3. **Проведите документ**
4. **Проверьте результат:**

```
Ожидаемые движения по регистру "ТоварыНаСкладах":

РАСХОД:
- Борщ украинский: 2 порции

РАСХОД ИНГРЕДИЕНТОВ (для 2 порций):
- Говядина (мякоть): 0.16 кг
- Картофель: 0.10 кг
- Морковь: 0.06 кг
- Лук репчатый: 0.05 кг
- ... и т.д.
```

5. **Проверьте регистр "СписаниеПоРецептам":**
   - Должна быть запись с рецептом, блюдом и ингредиентами

### Тест 2: Недостаток ингредиентов

1. **Установите недостаточные остатки** одного из ингредиентов
2. **Попытайтесь провести продажу**
3. **Ожидаемый результат:**
   - Документ не проводится
   - Выводится сообщение об ошибке
   - Указывается недостающий ингредиент и количество

### Тест 3: Отмена продажи

1. **Проведите документ продажи**
2. **Отмените проведение**
3. **Проверьте результат:**
   - Все движения по регистрам должны быть сторнированы
   - Остатки должны восстановиться

### Тест 4: Пересчет себестоимости

1. **Измените цену одного из ингредиентов**
2. **Откройте техкарточку**
3. **Нажмите "Пересчитать себестоимость"**
4. **Проверьте обновление цен**

### Устранение ошибок при тестировании

**Частые ошибки и их решения:**

1. **"Не найден рецепт для блюда"**
   - Проверьте связь между номенклатурой в рецепте и в документе продажи
   - Убедитесь, что рецепт не помечен на удаление

2. **"Техкарточка не найдена"**
   - Проверьте заполнение поля "Техкарточка" в рецепте
   - Убедитесь, что техкарточка не помечена на удаление

3. **"Ошибка при расчете себестоимости"**
   - Проверьте заполнение цен ингредиентов
   - Убедитесь в корректности норм в техкарточке

---

## ЕЖЕДНЕВНОЕ ИСПОЛЬЗОВАНИЕ

### Для поваров и кухонных работников

#### Получение техкарточки для приготовления:
1. **Получите заказ на приготовление блюда**
2. **Найдите техкарточку:**
   - Справочники → Технологические карты
   - Найдите нужное блюдо
   - Откройте техкарточку

3. **Изучите технологию приготовления:**
   - Перейдите на страницу "Технология"
   - Внимательно изучите все этапы
   - Обратите внимание на требования к сырью

4. **Проверьте наличие ингредиентов:**
   - Сверьте наличие всех продуктов по списку
   - При недостатке сообщите менеджеру

#### Соблюдение норм выхода:
- Строго соблюдайте нормы вложения
- Контролируйте выход готового блюда
- При отклонениях сообщайте технологу

### Для менеджеров по закупкам

#### Планирование закупок:
1. **Анализируйте прогноз продаж**
2. **Рассчитывайте потребность в ингредиентах:**
   - Используйте отчет "Потребность в ингредиентах"
   - Учитывайте текущие остатки
   - Добавляйте страховой запас

3. **Мониторьте цены поставщиков:**
   - При изменении цен обновляйте техкарточки
   - Отслеживайте влияние на себестоимость блюд

### Для кассиров и официантов

#### Оформление продаж:
- **Никаких дополнительных действий не требуется**
- Выбирайте готовые блюда из меню как обычно
- Система автоматически спишет все ингредиенты

#### При появлении ошибок:
- Если документ не проводится из-за нехватки ингредиентов
- Сообщите менеджеру или администратору
- Предложите клиенту альтернативное блюдо

### Для бухгалтеров и экономистов

#### Анализ себестоимости:
1. **Ежедневный контроль:**
   - Проверяйте корректность проведения документов продаж
   - Анализируйте отклонения от плановой себестоимости

2. **Еженедельный анализ:**
   - Отчет по использованию ингредиентов
   - Анализ рентабельности блюд
   - Выявление неэффективных позиций меню

3. **Ежемесячный анализ:**
   - Полный анализ себестоимости всех блюд
   - Корректировка цен с учетом изменения стоимости ингредиентов
   - Планирование меню на следующий месяц

---

## АДМИНИСТРИРОВАНИЕ И ОБСЛУЖИВАНИЕ

### Ежедневное обслуживание

#### Проверка корректности данных:
1. **Контроль остатков:**
   - Проверяйте остатки ингредиентов на складах
   - Выявляйте отрицательные остатки
   - Корректируйте при необходимости

2. **Проверка цен:**
   - Отслеживайте изменения цен поставщиков
   - Обновляйте цены в техкарточках
   - Пересчитывайте себестоимость

#### Мониторинг работы системы:
1. **Проверка журнала событий:**
   - Отслеживайте ошибки при проведении документов
   - Анализируйте причины сбоев
   - Принимайте корректирующие меры

### Еженедельное обслуживание

#### Анализ эффективности:
1. **Отчет по использованию ингредиентов:**
   - Выявляйте наиболее и наименее используемые продукты
   - Анализируйте эффективность закупок
   - Корректируйте планы поставок

2. **Контроль себестоимости:**
   - Сравнивайте плановую и фактическую себестоимость
   - Выявляйте причины отклонений
   - Принимайте корректирующие меры

### Ежемесячное обслуживание

#### Полное обновление данных:
1. **Ревизия техкарточек:**
   - Проверяйте актуальность всех техкарточек
   - Обновляйте устаревшие данные
   - Добавляйте новые блюда

2. **Анализ рентабельности:**
   - Рассчитывайте рентабельность каждого блюда
   - Выявляйте убыточные позиции
   - Принимайте решения по корректировке меню или цен

### Создание резервных копий

#### Регулярное резервирование:
1. **Ежедневно:**
   - Автоматическое резервирование информационной базы
   - Сохранение копий на отдельном носителе

2. **Еженедельно:**
   - Полная выгрузка конфигурации
   - Проверка целостности резервных копий

3. **Ежемесячно:**
   - Архивирование старых резервных копий
   - Тестирование восстановления из резервной копии

---

## РЕШЕНИЕ ПРОБЛЕМ

### Типичные ошибки и их устранение

#### Ошибка: "Не найден рецепт для блюда"

**Причины:**
- Отсутствует рецепт для проданного блюда
- Неправильная связь между номенклатурой в рецепте и в документе продажи
- Рецепт помечен на удаление

**Решение:**
1. Проверьте наличие рецепта для блюда
2. Убедитесь в правильности заполнения поля "Готовое блюдо" в рецепте
3. Проверьте, что рецепт не помечен на удаление

#### Ошибка: "Недостаточно ингредиента на складе"

**Причины:**
- Реальная нехватка продуктов
- Некорректные остатки в системе
- Завышенные нормы в техкарточке

**Решение:**
1. Проверьте фактические остатки на складе
2. Проведите инвентаризацию при необходимости
3. Скорректируйте остатки документом "Корректировка остатков"
4. Проверьте правильность норм в техкарточке

#### Ошибка: "Некорректная себестоимость"

**Причины:**
- Отсутствуют цены на ингредиенты
- Устаревшие цены в техкарточках
- Ошибки в нормах вложения

**Решение:**
1. Проверьте заполнение цен поставщиков
2. Обновите цены в техкарточках
3. Пересчитайте себестоимость
4. Проверьте правильность норм

#### Ошибка: "Техкарточка не найдена"

**Причины:**
- Не заполнено поле "Техкарточка" в рецепте
- Техкарточка помечена на удаление
- Техкарточка была удалена

**Решение:**
1. Откройте рецепт и заполните поле "Техкарточка"
2. Проверьте, что техкарточка не помечена на удаление
3. Восстановите техкарточку из резервной копии при необходимости

### Диагностика проблем

#### Проверочный список для диагностики:

1. **Проверка номенклатуры:**
   - [ ] Все блюда есть в справочнике номенклатуры
   - [ ] Все ингредиенты есть в справочнике номенклатуры
   - [ ] Правильно указаны единицы измерения
   - [ ] Заполнены цены ингредиентов

2. **Проверка техкарточек:**
   - [ ] Все техкарточки заполнены полностью
   - [ ] Правильно указаны нормы брутто/нетто
   - [ ] Корректные проценты отходов
   - [ ] Актуальные цены ингредиентов

3. **Проверка рецептов:**
   - [ ] Все рецепты связаны с техкарточками
   - [ ] Правильно указаны готовые блюда
   - [ ] Корректное количество порций
   - [ ] Рецепты не помечены на удаление

4. **Проверка документов:**
   - [ ] Документы продаж содержат правильную номенклатуру
   - [ ] Модуль документа содержит код списания ингредиентов
   - [ ] Документы проводятся корректно

### Инструменты диагностики

#### Консольная диагностика:
```bsl
// Проверка рецепта для блюда
Блюдо = Справочники.Номенклатура.НайтиПоНаименованию("Борщ украинский");
Рецепт = НайтиРецептДляБлюда(Блюдо);
Сообщить("Рецепт: " + Рецепт);

// Проверка техкарточки
Если ЗначениеЗаполнено(Рецепт) Тогда
    Сообщить("Техкарточка: " + Рецепт.Техкарточка);
КонецЕсли;

// Проверка состава ингредиентов
СоставИнгредиентов = ПолучитьСоставИнгредиентовДляБлюда(Блюдо, 1);
Для Каждого Строка Из СоставИнгредиентов Цикл
    Сообщить(Строка.Ингредиент + ": " + Строка.КоличествоНаПорцию);
КонецЦикла;
```

---

## ДОПОЛНИТЕЛЬНЫЕ ВОЗМОЖНОСТИ

### Расширенная аналитика

#### Отчет по использованию ингредиентов:
1. **Создайте новую обработку "АнализИспользованияИнгредиентов"**
2. **Добавьте параметры:**
   - Период анализа
   - Склад
   - Группа ингредиентов

3. **Реализуйте расчеты:**
   - Общее потребление по периоду
   - Средняя стоимость ингредиента
   - Динамика потребления
   - Топ-10 наиболее используемых ингредиентов

#### Отчет по рентабельности блюд:
1. **Создайте обработку "АнализРентабельностиБлюд"**
2. **Рассчитывайте показатели:**
   - Себестоимость блюда
   - Продажная цена
   - Валовая прибыль
   - Рентабельность в процентах
   - Объем продаж

### Интеграция с внешними системами

#### Импорт данных о пищевой ценности:
1. **Подключите справочники USDA или аналогичные**
2. **Создайте процедуру автоматического заполнения БЖУ**
3. **Настройте регулярное обновление данных**

#### Экспорт техкарточек:
1. **Реализуйте экспорт в Excel для печати**
2. **Создайте шаблоны для различных форматов техкарточек**
3. **Добавьте возможность экспорта в PDF**

### Мобильное приложение для поваров

#### Функциональность:
- Просмотр техкарточек на планшете или смартфоне
- Пошаговые инструкции по приготовлению
- Таймеры для контроля времени приготовления
- Возможность отметить готовность блюда

### Система ХАССП

#### Интеграция с системой ХАССП:
1. **Добавьте контрольные точки в техкарточки**
2. **Настройте контроль температур**
3. **Реализуйте журналирование процессов**
4. **Создайте отчеты для контролирующих органов**

### Планирование меню

#### Автоматическое планирование:
1. **Анализ популярности блюд**
2. **Оптимизация по себестоимости**
3. **Учет сезонности ингредиентов**
4. **Минимизация остатков продуктов**

### Контроль сроков годности

#### Система контроля:
1. **Добавьте сроки годности в номенклатуру ингредиентов**
2. **Настройте уведомления о просроченных продуктах**
3. **Реализуйте FIFO при списании ингредиентов**
4. **Создайте отчет по критическим остаткам**

---

## ЗАКЛЮЧЕНИЕ

### Контрольный список для завершения внедрения

#### Техническая готовность:
- [ ] Все объекты конфигурации созданы и настроены
- [ ] Модули документов обновлены
- [ ] Система успешно протестирована
- [ ] Созданы резервные копии

#### Данные готовы:
- [ ] Справочник номенклатуры заполнен полностью
- [ ] Созданы все необходимые техкарточки
- [ ] Рецепты связаны с техкарточками
- [ ] Цены ингредиентов актуализированы

#### Персонал готов:
- [ ] Проведено обучение всех пользователей
- [ ] Созданы инструкции для каждой роли
- [ ] Назначены ответственные за ведение системы
- [ ] Настроена техническая поддержка

### Ключевые преимущества системы

1. **Точный учет затрат** - себестоимость рассчитывается с точностью до копейки
2. **Автоматизация процессов** - исключение ручного труда при списании ингредиентов
3. **Контроль качества** - стандартизация процессов приготовления
4. **Планирование** - точное планирование закупок и остатков
5. **Соответствие стандартам** - техкарточки соответствуют требованиям общепита

### Дальнейшее развитие

После успешного внедрения системы рекомендуется:

1. **Расширение функциональности:**
   - Добавление новых отчетов
   - Интеграция с внешними системами
   - Разработка мобильных приложений

2. **Оптимизация процессов:**
   - Автоматизация обновления цен
   - Интеграция с поставщиками
   - Внедрение системы планирования

3. **Масштабирование:**
   - Внедрение в других точках продаж
   - Создание централизованной базы техкарточек
   - Стандартизация процессов в сети

---

**🎉 ПОЗДРАВЛЯЕМ! СИСТЕМА ТЕХНОЛОГИЧЕСКИХ КАРТ УСПЕШНО ВНЕДРЕНА!**

*Для получения технической поддержки или консультаций по развитию системы обращайтесь к разработчику.*