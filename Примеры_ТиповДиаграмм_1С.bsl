// Примеры различных типов диаграмм в 1C:Предприятие 8

#Область ПримерыТиповДиаграмм

&НаКлиенте
Процедура ПримерГистограммы()
    
    // 1. ГИСТОГРАММА - для сравнения значений по категориям
    Диаграмма.Очистить();
    Диаграмма.ТипДиаграммы = ТипДиаграммы.Гистограмма;
    Диаграмма.Заголовок = "Продажи по месяцам";
    
    // Добавляем серии
    СерияПродажи = Диаграмма.УстановитьСерию("Продажи");
    СерияПлан = Диаграмма.УстановитьСерию("План");
    
    // Добавляем точки
    Диаграмма.УстановитьТочку("Январь").УстановитьЗначение(СерияПродажи, 100);
    Диаграмма.УстановитьТочку("Январь").УстановитьЗначение(СерияПлан, 120);
    Диаграмма.УстановитьТочку("Февраль").УстановитьЗначение(СерияПродажи, 150);
    Диаграмма.УстановитьТочку("Февраль").УстановитьЗначение(СерияПлан, 140);
    
КонецПроцедуры

&НаКлиенте
Процедура ПримерГистограммыОбъемной()
    
    // 2. ОБЪЕМНАЯ ГИСТОГРАММА - для эффектного представления
    Диаграмма.Очистить();
    Диаграмма.ТипДиаграммы = ТипДиаграммы.ГистограммаОбъемная;
    Диаграмма.Заголовок = "Объемы производства";
    
    СерияОбъем = Диаграмма.УстановитьСерию("Объем");
    СерияОбъем.Цвет = WebЦвета.СинийСтальной;
    
    Диаграмма.УстановитьТочку("Цех 1").УстановитьЗначение(СерияОбъем, 250);
    Диаграмма.УстановитьТочку("Цех 2").УстановитьЗначение(СерияОбъем, 180);
    Диаграмма.УстановитьТочку("Цех 3").УстановитьЗначение(СерияОбъем, 320);
    
КонецПроцедуры

&НаКлиенте
Процедура ПримерКруговойДиаграммы()
    
    // 3. КРУГОВАЯ ДИАГРАММА - для показа долей от целого
    Диаграмма.Очистить();
    Диаграмма.ТипДиаграммы = ТипДиаграммы.Круговая;
    Диаграмма.Заголовок = "Структура затрат";
    
    СерияЗатраты = Диаграмма.УстановитьСерию("Затраты");
    
    // Точки с цветами
    ТочкаМатериалы = Диаграмма.УстановитьТочку("Материалы");
    ТочкаМатериалы.УстановитьЗначение(СерияЗатраты, 45);
    ТочкаМатериалы.Цвет = WebЦвета.Зеленый;
    
    ТочкаРабота = Диаграмма.УстановитьТочку("Работа");
    ТочкаРабота.УстановитьЗначение(СерияЗатраты, 30);
    ТочкаРабота.Цвет = WebЦвета.Синий;
    
    ТочкаНакладные = Диаграмма.УстановитьТочку("Накладные");
    ТочкаНакладные.УстановитьЗначение(СерияЗатраты, 25);
    ТочкаНакладные.Цвет = WebЦвета.Красный;
    
КонецПроцедуры

&НаКлиенте
Процедура ПримерОбъемнойКруговойДиаграммы()
    
    // 4. ОБЪЕМНАЯ КРУГОВАЯ ДИАГРАММА
    Диаграмма.Очистить();
    Диаграмма.ТипДиаграммы = ТипДиаграммы.КруговаяОбъемная;
    Диаграмма.Заголовок = "Доли рынка";
    
    СерияДоли = Диаграмма.УстановитьСерию("Доли");
    
    Диаграмма.УстановитьТочку("Наша компания").УстановитьЗначение(СерияДоли, 35);
    Диаграмма.УстановитьТочку("Конкурент А").УстановитьЗначение(СерияДоли, 25);
    Диаграмма.УстановитьТочку("Конкурент Б").УстановитьЗначение(СерияДоли, 20);
    Диаграмма.УстановитьТочку("Прочие").УстановитьЗначение(СерияДоли, 20);
    
КонецПроцедуры

&НаКлиенте
Процедура ПримерГрафика()
    
    // 5. ГРАФИК - для показа тенденций во времени
    Диаграмма.Очистить();
    Диаграмма.ТипДиаграммы = ТипДиаграммы.График;
    Диаграмма.Заголовок = "Динамика продаж";
    
    // Настройка осей
    Диаграмма.ОсьX.Заголовок = "Месяцы";
    Диаграмма.ОсьY.Заголовок = "Сумма продаж";
    
    СерияПродажи = Диаграмма.УстановитьСерию("Продажи");
    СерияПродажи.Цвет = WebЦвета.СинийТемный;
    СерияПродажи.ТипЛинии = ТипЛинииДиаграммы.Сплошная;
    СерияПродажи.ТипМаркера = ТипМаркераДиаграммы.Круг;
    
    // Добавляем точки
    Диаграмма.УстановитьТочку(1).УстановитьЗначение(СерияПродажи, 100);
    Диаграмма.УстановитьТочку(2).УстановитьЗначение(СерияПродажи, 120);
    Диаграмма.УстановитьТочку(3).УстановитьЗначение(СерияПродажи, 150);
    Диаграмма.УстановитьТочку(4).УстановитьЗначение(СерияПродажи, 180);
    
КонецПроцедуры

&НаКлиенте
Процедура ПримерОбластнойДиаграммы()
    
    // 6. ОБЛАСТНАЯ ДИАГРАММА - для показа накопительных значений
    Диаграмма.Очистить();
    Диаграмма.ТипДиаграммы = ТипДиаграммы.Областная;
    Диаграмма.Заголовок = "Накопительные продажи по регионам";
    
    СерияМосква = Диаграмма.УстановитьСерию("Москва");
    СерияСПб = Диаграмма.УстановитьСерию("СПб");
    СерияЕкб = Диаграмма.УстановитьСерию("Екатеринбург");
    
    СерияМосква.Цвет = WebЦвета.Красный;
    СерияСПб.Цвет = WebЦвета.Синий;
    СерияЕкб.Цвет = WebЦвета.Зеленый;
    
    // Заполняем данными
    Для Месяц = 1 По 6 Цикл
        Диаграмма.УстановитьТочку(Месяц).УстановитьЗначение(СерияМосква, Месяц * 50);
        Диаграмма.УстановитьТочку(Месяц).УстановитьЗначение(СерияСПб, Месяц * 30);
        Диаграмма.УстановитьТочку(Месяц).УстановитьЗначение(СерияЕкб, Месяц * 20);
    КонецЦикла;
    
КонецПроцедуры

&НаКлиенте
Процедура ПримерЛепестковойДиаграммы()
    
    // 7. ЛЕПЕСТКОВАЯ ДИАГРАММА - для сравнения многомерных данных
    Диаграмма.Очистить();
    Диаграмма.ТипДиаграммы = ТипДиаграммы.Лепестковая;
    Диаграмма.Заголовок = "Анализ показателей сотрудника";
    
    СерияСотрудник1 = Диаграмма.УстановитьСерию("Иванов");
    СерияСотрудник2 = Диаграмма.УстановитьСерию("Петров");
    
    СерияСотрудник1.Цвет = WebЦвета.Синий;
    СерияСотрудник2.Цвет = WebЦвета.Красный;
    
    // Критерии оценки
    Диаграмма.УстановитьТочку("Продажи").УстановитьЗначение(СерияСотрудник1, 8);
    Диаграмма.УстановитьТочку("Продажи").УстановитьЗначение(СерияСотрудник2, 6);
    
    Диаграмма.УстановитьТочку("Качество").УстановитьЗначение(СерияСотрудник1, 7);
    Диаграмма.УстановитьТочку("Качество").УстановитьЗначение(СерияСотрудник2, 9);
    
    Диаграмма.УстановитьТочку("Пунктуальность").УстановитьЗначение(СерияСотрудник1, 9);
    Диаграмма.УстановитьТочку("Пунктуальность").УстановитьЗначение(СерияСотрудник2, 8);
    
    Диаграмма.УстановитьТочку("Инициативность").УстановитьЗначение(СерияСотрудник1, 6);
    Диаграмма.УстановитьТочку("Инициативность").УстановитьЗначение(СерияСотрудник2, 7);
    
КонецПроцедуры

&НаКлиенте
Процедура ПримерКомбинированнойДиаграммы()
    
    // 8. КОМБИНИРОВАННАЯ ДИАГРАММА - сочетание разных типов
    Диаграмма.Очистить();
    Диаграмма.ТипДиаграммы = ТипДиаграммы.Гистограмма; // Основной тип
    Диаграмма.Заголовок = "Продажи и рентабельность";
    
    // Серия для гистограммы (продажи)
    СерияПродажи = Диаграмма.УстановитьСерию("Продажи");
    СерияПродажи.Цвет = WebЦвета.Синий;
    
    // Серия для графика (рентабельность)
    СерияРентабельность = Диаграмма.УстановитьСерию("Рентабельность %");
    СерияРентабельность.ТипДиаграммы = ТипДиаграммы.График;
    СерияРентабельность.Цвет = WebЦвета.Красный;
    СерияРентабельность.ТипЛинии = ТипЛинииДиаграммы.Сплошная;
    СерияРентабельность.ТипМаркера = ТипМаркераДиаграммы.Ромб;
    
    // Заполняем данными
    Диаграмма.УстановитьТочку("Январь").УстановитьЗначение(СерияПродажи, 1000);
    Диаграмма.УстановитьТочку("Январь").УстановитьЗначение(СерияРентабельность, 15);
    
    Диаграмма.УстановитьТочку("Февраль").УстановитьЗначение(СерияПродажи, 1200);
    Диаграмма.УстановитьТочку("Февраль").УстановитьЗначение(СерияРентабельность, 18);
    
    Диаграмма.УстановитьТочку("Март").УстановитьЗначение(СерияПродажи, 800);
    Диаграмма.УстановитьТочку("Март").УстановитьЗначение(СерияРентабельность, 12);
    
КонецПроцедуры

#КонецОбласти

#Область НастройкиДиаграмм

&НаКлиенте
Процедура НастройкиВнешнегоВида()
    
    // Настройки цветов и стилей
    Диаграмма.ФонПрозрачный = Ложь;
    Диаграмма.ЦветФона = WebЦвета.БелыйДым;
    
    // Настройка легенды
    Диаграмма.ЛегендаИспользование = ИспользованиеЛегендыДиаграммы.Использовать;
    Диаграмма.ЛегендаРасположение = РасположениеЛегендыДиаграммы.Право;
    
    // Настройка осей
    Диаграмма.ОсьX.ОтображениеЗаголовка = ОтображениеЗаголовкаОсиДиаграммы.Отображать;
    Диаграмма.ОсьY.ОтображениеЗаголовка = ОтображениеЗаголовкаОсиДиаграммы.Отображать;
    
    // Сетка
    Диаграмма.ОсьX.Сетка = ОтображениеСеткиДиаграммы.Отображать;
    Диаграмма.ОсьY.Сетка = ОтображениеСеткиДиаграммы.Отображать;
    
    // Масштаб
    Диаграмма.ОсьY.МинимальноеЗначение = 0;
    Диаграмма.ОсьY.МаксимальноеЗначение = 1000;
    
КонецПроцедуры

&НаКлиенте
Процедура НастройкиИнтерактивности()
    
    // Включение подсказок
    Диаграмма.ПоказыватьЗначения = Истина;
    Диаграмма.ПоказыватьСерии = Истина;
    Диаграмма.ПоказыватьТочки = Истина;
    
    // Анимация
    Диаграмма.ЭффектАнимации = ЭффектАнимацииДиаграммы.Нет;
    
КонецПроцедуры

#КонецОбласти

#Область ПримерыИспользованияСТабличнымДокументом

&НаСервере
Процедура СоздатьДиаграммуВТабличномДокументе()
    
    // Создание диаграммы в табличном документе
    ТабДок = Новый ТабличныйДокумент;
    
    // Создаем область диаграммы
    ОбластьДиаграммы = ТабДок.Рисунки.Добавить(ТипРисункаТабличногоДокумента.Диаграмма);
    ОбластьДиаграммы.Диаграмма = Новый Диаграмма;
    
    // Настраиваем диаграмму
    ОбластьДиаграммы.Диаграмма.ТипДиаграммы = ТипДиаграммы.Гистограмма;
    ОбластьДиаграммы.Диаграмма.Заголовок = "Продажи по кварталам";
    
    // Добавляем данные
    Серия = ОбластьДиаграммы.Диаграмма.УстановитьСерию("Продажи");
    ОбластьДиаграммы.Диаграмма.УстановитьТочку("Q1").УстановитьЗначение(Серия, 1000);
    ОбластьДиаграммы.Диаграмма.УстановитьТочку("Q2").УстановитьЗначение(Серия, 1200);
    ОбластьДиаграммы.Диаграмма.УстановитьТочку("Q3").УстановитьЗначение(Серия, 900);
    ОбластьДиаграммы.Диаграмма.УстановитьТочку("Q4").УстановитьЗначение(Серия, 1500);
    
    // Размещение в документе
    ОбластьДиаграммы.Лево = 10;
    ОбластьДиаграммы.Верх = 10;
    ОбластьДиаграммы.Ширина = 400;
    ОбластьДиаграммы.Высота = 300;
    
КонецПроцедуры

#КонецОбласти

#Область ПрограммноеСозданиеДиаграмм

&НаСервере
Функция СоздатьДиаграммуПрограммно(ДанныеДляДиаграммы)
    
    // Программное создание диаграммы из таблицы значений
    НоваяДиаграмма = Новый Диаграмма;
    НоваяДиаграмма.ТипДиаграммы = ТипДиаграммы.Гистограмма;
    
    // Автоматическое заполнение из таблицы значений
    НоваяДиаграмма.ИсточникДанных = ДанныеДляДиаграммы;
    НоваяДиаграмма.СерииИзКолонок = Истина; // Серии из колонок
    НоваяДиаграмма.ТочкиИзСтрок = Истина;   // Точки из строк
    
    // Указываем колонки для использования
    НоваяДиаграмма.СерииИзКолонок = Истина;
    
    Возврат НоваяДиаграмма;
    
КонецФункции

&НаСервере
Процедура ЗаполнитьДиаграммуИзЗапроса()
    
    // Пример заполнения диаграммы из результата запроса
    Запрос = Новый Запрос;
    Запрос.Текст = 
    "ВЫБРАТЬ
    |    Номенклатура.Наименование КАК Товар,
    |    СУММА(ПродажиОбороты.КоличествоОборот) КАК КоличествоПродано,
    |    СУММА(ПродажиОбороты.СуммаОборот) КАК СуммаПродаж
    |ИЗ
    |    РегистрНакопления.Продажи.Обороты(, , , ) КАК ПродажиОбороты
    |        ЛЕВОЕ СОЕДИНЕНИЕ Справочник.Номенклатура КАК Номенклатура
    |        ПО ПродажиОбороты.Номенклатура = Номенклатура.Ссылка
    |СГРУППИРОВАТЬ ПО
    |    Номенклатура.Наименование
    |УПОРЯДОЧИТЬ ПО
    |    СуммаПродаж УБЫВ";
    
    Результат = Запрос.Выполнить();
    ТаблицаДанных = Результат.Выгрузить();
    
    // Создаем диаграмму из результата
    Диаграмма.Очистить();
    Диаграмма.ИсточникДанных = ТаблицаДанных;
    Диаграмма.ПолеТочек = "Товар";
    
    // Добавляем серии
    СерияКоличество = Диаграмма.УстановитьСерию("КоличествоПродано");
    СерияСумма = Диаграмма.УстановитьСерию("СуммаПродаж");
    
КонецПроцедуры

#КонецОбласти