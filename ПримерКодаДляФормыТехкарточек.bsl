// ПРИМЕР КОДА ДЛЯ МОДУЛЯ ФОРМЫ СПРАВОЧНИКА "ТЕХКАРТОЧКИ"
// Добавьте эти процедуры в существующий модуль формы техкарточек

&НаКлиенте
Процедура СоставИнгредиентовЦенаИнгредиентаПриИзменении(Элемент)

	ТекущаяСтрока = Элементы.СоставИнгредиентов.ТекущиеДанные;
	Если ТекущаяСтрока = Неопределено Тогда
		Возврат;
	КонецЕсли;

	// Заполняем цену при выборе
	Если ЗначениеЗаполнено(ТекущаяСтрока.ЦенаИнгредиента) Тогда
		ТекущаяСтрока.СтоимостьЕдиницы = ТекущаяСтрока.ЦенаИнгредиента.ЦенаЗаЕдиницу;

		// Пересчитываем сумму
		ТекущаяСтрока.СуммаСтоимости = (ТекущаяСтрока.НормаБрутто / 1000) * ТекущаяСтрока.СтоимостьЕдиницы;

		// Обновляем общую себестоимость
		ОбновитьСебестоимостьПорцииНаСервере();
	КонецЕсли;

КонецПроцедуры

&НаКлиенте
Процедура СоставИнгредиентовИнгредиентПриИзменении(Элемент)

	ТекущаяСтрока = Элементы.СоставИнгредиентов.ТекущиеДанные;
	Если ТекущаяСтрока = Неопределено Тогда
		Возврат;
	КонецЕсли;

	// Очищаем поле цены при изменении ингредиента
	ТекущаяСтрока.ЦенаИнгредиента = Справочники.ЦеныНаИнгредиенты.ПустаяСсылка();
	ТекущаяСтрока.СтоимостьЕдиницы = 0;
	ТекущаяСтрока.СуммаСтоимости = 0;

КонецПроцедуры

&НаКлиенте
Процедура СоставИнгредиентовНормаБруттоПриИзменении(Элемент)

	ТекущаяСтрока = Элементы.СоставИнгредиентов.ТекущиеДанные;
	Если ТекущаяСтрока = Неопределено Тогда
		Возврат;
	КонецЕсли;

	// Пересчитываем сумму при изменении нормы
	ТекущаяСтрока.СуммаСтоимости = (ТекущаяСтрока.НормаБрутто / 1000) * ТекущаяСтрока.СтоимостьЕдиницы;

	// Обновляем общую себестоимость
	ОбновитьСебестоимостьПорцииНаСервере();

КонецПроцедуры

&НаСервере
Процедура ОбновитьСебестоимостьПорцииНаСервере()

	// Используем правильное имя модуля
	РасчетСебестоимостиМодуль.ОбновитьЦеныВТехКарточке(Объект);

КонецПроцедуры

&НаКлиенте
Процедура ОбновитьВсеЦены(Команда)

	ОбновитьСебестоимостьПорцииНаСервере();
	Сообщить("Цены обновлены из справочника");

КонецПроцедуры