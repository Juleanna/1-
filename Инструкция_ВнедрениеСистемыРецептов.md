# Система кулинарных рецептов для БАС Управление торговли

## Описание функциональности

Разработанная система позволяет:
- Вести справочник кулинарных рецептов с детальным составом ингредиентов
- Связывать готовые блюда из основной номенклатуры с рецептами
- Автоматически списывать ингредиенты при продаже блюд через кассу
- Анализировать себестоимость и использование ингредиентов
- Планировать потребности в ингредиентах

## Состав решения

### 1. Справочник "Кулинарные рецепты"
**Файлы:**
- `Справочник_КулинарныеРецепты.xml` - структура справочника
- `Справочник_КулинарныеРецепты.bsl` - модуль справочника
- `Форма_КулинарныеРецепты.xml` - форма элемента

**Реквизиты:**
- Код, Наименование - стандартные реквизиты
- ГотовоеБлюдо (Справочник.Номенклатура) - связь с основной номенклатурой
- КатегорияБлюда (Перечисление.КатегорииБлюд) - категория блюда
- ВремяПриготовления (Число) - время приготовления в минутах
- КоличествоПорций (Число) - количество порций в рецепте
- СебестоимостьПорции (Число) - расчетная себестоимость порции
- ТехнологияПриготовления (Строка) - описание технологии приготовления

**Табличная часть "СоставИнгредиентов":**
- Ингредиент (Справочник.Номенклатура) - ссылка на ингредиент
- Количество (Число) - количество ингредиента
- ЕдиницаИзмерения (Справочник.КлассификаторЕдиницИзмерения)
- СтоимостьЕдиницы (Число) - стоимость единицы ингредиента
- СуммаСтоимости (Число) - общая стоимость ингредиента
- Комментарий (Строка) - дополнительные сведения

### 2. Перечисление "Категории блюд"
**Файл:** `Перечисление_КатегорииБлюд.xml`

**Значения:**
- Супы
- Вторые блюда
- Гарниры
- Салаты
- Десерты
- Напитки
- Выпечка
- Горячие закуски
- Холодные закуски

### 3. Автоматическое списание ингредиентов
**Файл:** `Документ_ПродажаБлюд_СписаниеИнгредиентов.bsl`

**Принцип работы:**
1. При проведении документа продажи система проверяет, есть ли среди проданных товаров готовые блюда
2. Для каждого блюда ищется соответствующий рецепт
3. По рецепту рассчитывается необходимое количество каждого ингредиента
4. Проверяется наличие ингредиентов на складе
5. Создаются движения по регистру "ТоварыНаСкладах" (списание ингредиентов)
6. Создаются аналитические записи в регистре "СписаниеПоРецептам"

### 4. Регистр накопления "Списание по рецептам"
**Файл:** `РегистрНакопления_СписаниеПоРецептам.xml`

**Назначение:** Аналитика использования ингредиентов по рецептам

**Измерения:**
- Рецепт - кулинарный рецепт
- ГотовоеБлюдо - реализованное блюдо
- Ингредиент - использованный ингредиент
- Склад - склад списания

**Ресурсы:**
- КоличествоПорций - количество приготовленных порций
- КоличествоИнгредиента - количество использованного ингредиента
- СтоимостьИнгредиента - стоимость использованного ингредиента

### 5. Обработка анализа себестоимости
**Файл:** `Обработка_АнализСебестоимостиБлюд.bsl`

**Функции:**
- Анализ использования ингредиентов за период
- Расчет фактической себестоимости блюд
- Детализация по ингредиентам
- Планирование потребностей в ингредиентах

### 6. Тестирование системы
**Файл:** `Тестирование_СистемыРецептов.bsl`

Процедура комплексного тестирования всей функциональности.

## Инструкция по внедрению

### Шаг 1: Загрузка объектов конфигурации
1. Добавьте в конфигурацию справочник "КулинарныеРецепты"
2. Добавьте перечисление "КатегорииБлюд"
3. Добавьте регистр накопления "СписаниеПоРецептам"
4. Добавьте обработку "АнализСебестоимостиБлюд"

### Шаг 2: Модификация документов продажи
1. В модуле документа "ПродажиТоваровУслуг" (или аналогичного) добавьте код из файла `Документ_ПродажаБлюд_СписаниеИнгредиентов.bsl` в процедуры:
   - ОбработкаПроведения()
   - ОбработкаОтменыПроведения()

### Шаг 3: Настройка номенклатуры
1. Создайте виды номенклатуры:
   - "Готовые блюда" - для блюд в меню
   - "Материалы" или "Ингредиенты" - для компонентов блюд

2. Заполните номенклатуру:
   - Добавьте все готовые блюда, которые продаются через кассу
   - Добавьте все ингредиенты, используемые в рецептах

### Шаг 4: Настройка рецептов
1. Откройте справочник "Кулинарные рецепты"
2. Создайте рецепты для всех готовых блюд:
   - Заполните основные реквизиты (название, категория, время приготовления)
   - Обязательно укажите связь с номенклатурой готового блюда
   - Добавьте все ингредиенты в табличную часть
   - Укажите точные количества и единицы измерения
   - Воспользуйтесь кнопкой "Пересчитать себестоимость" для автоматического расчета

### Шаг 5: Тестирование
1. Запустите тестовую процедуру: `ТестироватьСистемуРецептов()`
2. Проверьте корректность работы на реальных данных:
   - Создайте тестовый рецепт
   - Оформите продажу через кассу
   - Убедитесь в автоматическом списании ингредиентов

## Инструкция по использованию

### Для менеджера по рецептам:
1. **Создание рецепта:**
   - Справочники → Кулинарные рецепты → Создать
   - Заполнить все обязательные поля
   - Добавить ингредиенты в табличную часть
   - Пересчитать себестоимость
   - Записать и закрыть

2. **Редактирование рецепта:**
   - При изменении ингредиентов обязательно пересчитывать себестоимость
   - Следить за актуальностью цен ингредиентов

### Для кассира:
- Никаких дополнительных действий не требуется
- Списание ингредиентов происходит автоматически при оформлении продажи

### Для аналитика/бухгалтера:
1. **Анализ себестоимости:**
   - Обработки → Анализ себестоимости блюд
   - Выбрать период и склад
   - Получить отчет по использованию ингредиентов

2. **Планирование закупок:**
   - Использовать функцию расчета прогнозных потребностей
   - Анализировать остатки ингредиентов на складах

## Особенности и ограничения

1. **Контроль остатков:**
   - При недостаточном количестве ингредиентов на складе документ продажи не проводится
   - Выводится сообщение с указанием недостающих ингредиентов

2. **Единицы измерения:**
   - Необходимо соблюдать единообразие единиц измерения
   - Рекомендуется использовать базовые единицы (граммы, миллилитры)

3. **Актуализация цен:**
   - Стоимость ингредиентов подтягивается из последних поступлений
   - Рекомендуется периодически пересчитывать себестоимость рецептов

4. **Производительность:**
   - При большом количестве рецептов и ингредиентов возможны задержки при проведении документов
   - Рекомендуется оптимизировать запросы для конкретной базы данных

## Возможные доработки

1. **Интеграция с планированием производства**
2. **Автоматический пересчет себестоимости по расписанию**  
3. **Контроль сроков годности ингредиентов**
4. **Система уведомлений о критических остатках**
5. **Мобильное приложение для поваров**
6. **Печать технологических карт**

## Поддержка

При возникновении вопросов или проблем обращайтесь к разработчику системы с указанием:
- Версии конфигурации
- Описания проблемы
- Скриншотов ошибок
- Примера данных, на которых возникла проблема